import{a as Q}from"./chunk-3EFWZ452.js";import{a as N}from"./chunk-FTVJFWHL.js";import{b as z,d as G,e as U,g as B,h as A,i as L,n as q,o as H,q as Y,t as J,w as K}from"./chunk-A3SAA77A.js";import{a as v}from"./chunk-JXVCW6UT.js";import"./chunk-OLM244A5.js";import"./chunk-EVJP5UTO.js";import{a as F}from"./chunk-RGDPBHKT.js";import{$ as m,Ab as _,Bb as S,Gb as T,Ib as I,Ja as s,Na as h,Sa as O,Xa as b,_ as p,a as w,b as E,bc as R,cb as u,cc as W,fb as P,fc as j,gb as e,hb as i,hc as D,ib as x,lb as M,mb as g,nb as d,sb as V,tb as r,ub as C,vb as y,wb as k,zb as f}from"./chunk-VLARTZ6X.js";function Z(c,l){if(c&1){let t=M();e(0,"tr")(1,"td"),r(2),T(3,"date"),i(),e(4,"td"),r(5),i(),e(6,"td"),r(7),i(),e(8,"td"),r(9),i(),e(10,"td"),r(11),i(),e(12,"td")(13,"span",13),r(14),i()(),e(15,"td",14)(16,"button",15),g("click",function(){let n=p(t).$implicit,o=d(2);return m(o.editSession(n))}),x(17,"i",16),i(),e(18,"button",17),g("click",function(){let n=p(t).$implicit,o=d(2);return m(o.deleteSession(n._id))}),x(19,"i",18),i()()()}if(c&2){let t=l.$implicit;s(2),C(I(3,9,t.date,"dd/MM/yyyy")),s(3),k("",t.startTime," - ",t.endTime,""),s(2),C(t.classGroup==null?null:t.classGroup.name),s(2),C(t.subject==null?null:t.subject.name),s(2),C(t.room),s(2),P(t.status),s(),C(t.status)}}function $(c,l){if(c&1&&(e(0,"table")(1,"thead")(2,"tr")(3,"th"),r(4,"Date"),i(),e(5,"th"),r(6,"Heure"),i(),e(7,"th"),r(8,"Classe"),i(),e(9,"th"),r(10,"Mati\xE8re"),i(),e(11,"th"),r(12,"Salle"),i(),e(13,"th"),r(14,"Statut"),i(),e(15,"th"),r(16,"Actions"),i()()(),e(17,"tbody"),b(18,Z,20,12,"tr",12),i()()),c&2){let t=d();s(18),u("ngForOf",t.sessions)}}function ee(c,l){c&1&&(e(0,"div",19),x(1,"i",20),e(2,"p"),r(3,"Aucune s\xE9ance de rattrapage trouv\xE9e."),i()())}function te(c,l){if(c&1&&(e(0,"option",45),r(1),i()),c&2){let t=l.$implicit;u("value",t._id),s(),C(t.name)}}function ne(c,l){if(c&1&&(e(0,"option",45),r(1),i()),c&2){let t=l.$implicit;u("value",t._id),s(),C(t.name)}}function ie(c,l){if(c&1){let t=M();e(0,"div",21),g("click",function(){p(t);let n=d();return m(n.closeModal())}),e(1,"div",22),g("click",function(n){return p(t),m(n.stopPropagation())}),e(2,"header",23)(3,"h2"),r(4),i(),e(5,"button",24),g("click",function(){p(t);let n=d();return m(n.closeModal())}),x(6,"i",25),i()(),e(7,"form",26,0),g("ngSubmit",function(){p(t);let n=d();return m(n.saveSession())}),e(9,"div",27)(10,"div",28)(11,"label"),r(12,"Classe"),i(),e(13,"select",29),S("ngModelChange",function(n){p(t);let o=d();return _(o.currentSession.classGroup,n)||(o.currentSession.classGroup=n),m(n)}),b(14,te,2,2,"option",30),i()(),e(15,"div",28)(16,"label"),r(17,"Mati\xE8re"),i(),e(18,"select",31),S("ngModelChange",function(n){p(t);let o=d();return _(o.currentSession.subject,n)||(o.currentSession.subject=n),m(n)}),b(19,ne,2,2,"option",30),i()(),e(20,"div",28)(21,"label"),r(22,"Date"),i(),e(23,"input",32),S("ngModelChange",function(n){p(t);let o=d();return _(o.currentSession.date,n)||(o.currentSession.date=n),m(n)}),i()(),e(24,"div",28)(25,"label"),r(26,"Salle"),i(),e(27,"input",33),S("ngModelChange",function(n){p(t);let o=d();return _(o.currentSession.room,n)||(o.currentSession.room=n),m(n)}),i()(),e(28,"div",28)(29,"label"),r(30,"Heure D\xE9but"),i(),e(31,"input",34),S("ngModelChange",function(n){p(t);let o=d();return _(o.currentSession.startTime,n)||(o.currentSession.startTime=n),m(n)}),i()(),e(32,"div",28)(33,"label"),r(34,"Heure Fin"),i(),e(35,"input",35),S("ngModelChange",function(n){p(t);let o=d();return _(o.currentSession.endTime,n)||(o.currentSession.endTime=n),m(n)}),i()(),e(36,"div",36)(37,"label"),r(38,"Statut"),i(),e(39,"select",37),S("ngModelChange",function(n){p(t);let o=d();return _(o.currentSession.status,n)||(o.currentSession.status=n),m(n)}),e(40,"option",38),r(41,"Publi\xE9"),i(),e(42,"option",39),r(43,"Brouillon"),i(),e(44,"option",40),r(45,"Annul\xE9"),i()()(),e(46,"div",36)(47,"label"),r(48,"Notes / Description (Optionnel)"),i(),e(49,"textarea",41),S("ngModelChange",function(n){p(t);let o=d();return _(o.currentSession.description,n)||(o.currentSession.description=n),m(n)}),i()()(),e(50,"div",42)(51,"button",43),g("click",function(){p(t);let n=d();return m(n.closeModal())}),r(52,"Annuler"),i(),e(53,"button",44),r(54),i()()()()()}if(c&2){let t=V(8),a=d();s(4),y("",a.isEditing?"Modifier":"Nouvelle"," S\xE9ance de Rattrapage"),s(9),f("ngModel",a.currentSession.classGroup),s(),u("ngForOf",a.classes),s(4),f("ngModel",a.currentSession.subject),s(),u("ngForOf",a.subjects),s(4),f("ngModel",a.currentSession.date),s(4),f("ngModel",a.currentSession.room),s(4),f("ngModel",a.currentSession.startTime),s(4),f("ngModel",a.currentSession.endTime),s(4),f("ngModel",a.currentSession.status),s(10),f("ngModel",a.currentSession.description),s(4),u("disabled",!t.valid),s(),y(" ",a.isEditing?"Mettre \xE0 jour":"Cr\xE9er la s\xE9ance"," ")}}var X=class c{constructor(l,t,a){this.catchupService=l;this.authService=t;this.http=a;this.sessions=[];this.classes=[];this.subjects=[];this.loading=!0;this.showModal=!1;this.isEditing=!1;this.currentSession=this.getEmptySession();this.authService.currentUser.subscribe(n=>this.currentUser=n)}ngOnInit(){this.loadData()}getEmptySession(){return{classGroup:"",subject:"",teacher:"",date:"",startTime:"",endTime:"",room:"",status:"published",description:""}}loadData(){let l=this.currentUser?.id||this.currentUser?._id;l&&(this.catchupService.getCatchupSessions(void 0,l).subscribe(t=>{this.sessions=t,this.loading=!1}),this.http.get(`${v.apiUrl}/public/classes`).subscribe(t=>{this.classes=t}),this.http.get(`${v.apiUrl}/public/modules`).subscribe(t=>{this.subjects=t}))}openCreateModal(){this.currentSession=this.getEmptySession(),this.currentSession.teacher=this.currentUser?.id||this.currentUser?._id,this.isEditing=!1,this.showModal=!0}editSession(l){this.isEditing=!0,this.currentSession=E(w({},l),{classGroup:l.classGroup?._id||l.classGroup,subject:l.subject?._id||l.subject,date:new Date(l.date).toISOString().split("T")[0]}),this.showModal=!0}closeModal(){this.showModal=!1}saveSession(){this.isEditing?this.catchupService.updateCatchupSession(this.currentSession._id,this.currentSession).subscribe(()=>{this.loadData(),this.closeModal()}):this.catchupService.createCatchupSession(this.currentSession).subscribe(()=>{this.loadData(),this.closeModal()})}deleteSession(l){confirm("Voulez-vous vraiment supprimer cette s\xE9ance ?")&&this.catchupService.deleteCatchupSession(l).subscribe(()=>{this.loadData()})}static{this.\u0275fac=function(t){return new(t||c)(h(Q),h(N),h(F))}}static{this.\u0275cmp=O({type:c,selectors:[["app-staff-rattrapage"]],decls:15,vars:3,consts:[["sessionForm","ngForm"],[1,"staff-rattrapage-container"],[1,"page-header","animate-fade-in"],[1,"header-content"],[1,"text-muted"],[1,"btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"glass-card","animate-fade-up"],[1,"table-container"],[4,"ngIf"],["class","no-data",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"status-badge"],[1,"actions"],["title","Modifier",1,"btn-icon",3,"click"],[1,"fas","fa-edit"],["title","Supprimer",1,"btn-icon","delete",3,"click"],[1,"fas","fa-trash-alt"],[1,"no-data"],[1,"fas","fa-calendar-alt"],[1,"modal-overlay",3,"click"],[1,"modal-content","glass-card",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"fas","fa-times"],[3,"ngSubmit"],[1,"form-grid"],[1,"form-group"],["name","classGroup","required","",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["name","subject","required","",3,"ngModelChange","ngModel"],["type","date","name","date","required","",3,"ngModelChange","ngModel"],["type","text","name","room","placeholder","ex: Salle 101","required","",3,"ngModelChange","ngModel"],["type","time","name","startTime","required","",3,"ngModelChange","ngModel"],["type","time","name","endTime","required","",3,"ngModelChange","ngModel"],[1,"form-group","full-width"],["name","status",3,"ngModelChange","ngModel"],["value","published"],["value","draft"],["value","cancelled"],["name","description","rows","3",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"btn-secondary",3,"click"],["type","submit",1,"btn-primary",3,"disabled"],[3,"value"]],template:function(t,a){t&1&&(e(0,"div",1)(1,"header",2)(2,"div",3)(3,"h1"),r(4,"\u{1F6E0}\uFE0F Gestion des Rattrapages"),i(),e(5,"p",4),r(6,"Cr\xE9ez et g\xE9rez les s\xE9ances de rattrapage pour vos classes."),i()(),e(7,"button",5),g("click",function(){return a.openCreateModal()}),x(8,"i",6),r(9," Nouvelle S\xE9ance "),i()(),e(10,"div",7)(11,"div",8),b(12,$,19,1,"table",9)(13,ee,4,0,"div",10),i()(),b(14,ie,55,13,"div",11),i()),t&2&&(s(12),u("ngIf",a.sessions.length>0),s(),u("ngIf",a.sessions.length===0&&!a.loading),s(),u("ngIf",a.showModal))},dependencies:[D,R,W,j,K,L,H,Y,z,q,G,U,J,A,B],styles:[".staff-rattrapage-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:800;color:#0f172a;margin:0}.glass-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:1.5rem;box-shadow:0 10px 15px -3px #0000000d;border:1px solid #f1f5f9}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;padding:1.2rem;color:#64748b;font-size:.85rem;text-transform:uppercase;letter-spacing:.5px;border-bottom:2px solid #f1f5f9}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1.2rem;border-bottom:1px solid #f1f5f9;color:#1e293b;font-size:.95rem}.btn-primary[_ngcontent-%COMP%]{background:#0055a4;color:#fff;border:none;padding:.8rem 1.5rem;border-radius:12px;font-weight:700;display:flex;align-items:center;gap:.8rem;cursor:pointer;transition:all .3s ease}.btn-primary[_ngcontent-%COMP%]:hover{background:#048;transform:translateY(-2px);box-shadow:0 4px 12px #0055a433}.btn-primary[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:#f1f5f9;color:#475569;border:none;padding:.8rem 1.5rem;border-radius:12px;font-weight:700;cursor:pointer}.btn-icon[_ngcontent-%COMP%]{background:none;border:none;color:#64748b;cursor:pointer;font-size:1.1rem;transition:all .2s}.btn-icon[_ngcontent-%COMP%]:hover{color:#0055a4}.btn-icon.delete[_ngcontent-%COMP%]:hover{color:#ef4444}.status-badge[_ngcontent-%COMP%]{font-size:.75rem;font-weight:800;padding:4px 12px;border-radius:20px;text-transform:uppercase}.status-badge.published[_ngcontent-%COMP%]{background:#dcfce7;color:#15803d}.status-badge.draft[_ngcontent-%COMP%]{background:#fef9c3;color:#a16207}.status-badge.cancelled[_ngcontent-%COMP%]{background:#fee2e2;color:#b91c1c}.no-data[_ngcontent-%COMP%]{padding:4rem;text-align:center;color:#94a3b8}.no-data[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:1rem;opacity:.3}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0f172a99;backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{width:100%;max-width:600px;padding:2.5rem}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:800;color:#0f172a;margin:0}.modal-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.2rem;color:#64748b;cursor:pointer}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-group.full-width[_ngcontent-%COMP%]{grid-column:span 2}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:700;color:#475569}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:.8rem;border:1px solid #e2e8f0;border-radius:10px;font-family:inherit}[_ngcontent-%COMP%]:is(.form-group input,.form-group select,.form-group textarea):focus{outline:none;border-color:#0055a4;box-shadow:0 0 0 3px #0055a41a}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:2.5rem}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .4s ease-out}.animate-fade-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeUp .4s ease-out both}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_fadeUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}"]})}};export{X as StaffRattrapageComponent};
