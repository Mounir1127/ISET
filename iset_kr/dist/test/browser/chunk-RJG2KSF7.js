import{b as U,d as W,e as O,g as V,h as $,i as D,n as L,o as j,q,t as z,w as B}from"./chunk-A3SAA77A.js";import{a as N}from"./chunk-JXVCW6UT.js";import{a as T}from"./chunk-RGDPBHKT.js";import{$ as v,Ab as b,Bb as P,Ga as f,Ja as l,Na as E,Sa as M,Xa as g,_ as y,a as S,bc as A,cb as m,cc as I,db as x,eb as C,gb as n,hb as t,hc as F,ib as c,lb as w,mb as p,nb as u,tb as o,ub as k,vb as _,zb as h}from"./chunk-VLARTZ6X.js";function G(s,e){if(s&1&&(n(0,"p",41)(1,"a",42),c(2,"i",43),o(3),t()()),s&2){let i=u().$implicit;l(),m("href",i.link,f),l(2),_(" ",i.link,"")}}function R(s,e){if(s&1){let i=w();n(0,"div",29)(1,"div",30)(2,"div",31),c(3,"img",32),n(4,"h5",33),o(5),t(),n(6,"div",34),o(7),t(),g(8,G,4,2,"p",35),t(),n(9,"div",36)(10,"button",37),p("click",function(){let d=y(i).$implicit,a=u();return v(a.editPartner(d))}),c(11,"i",38),t(),n(12,"button",39),p("click",function(){let d=y(i).$implicit,a=u();return v(a.deletePartner(d))}),c(13,"i",40),t()()()()}if(s&2){let i=e.$implicit,r=u();l(3),m("src",r.getImageUrl(i.logo),f)("alt",i.name),l(2),k(i.name),l(),C("bg-info",i.type==="academic")("bg-warning",i.type==="industrial")("bg-success",i.type==="international"),l(),_(" ",r.getTypeName(i.type)," "),l(),m("ngIf",i.link)}}function J(s,e){if(s&1&&(n(0,"div",44)(1,"small"),o(2,"Logo actuel:"),t(),c(3,"br")(4,"img",45),t()),s&2){let i=u();l(4),m("src",i.getImageUrl(i.currentPartner.logo),f)}}function K(s,e){s&1&&c(0,"div",46)}var H=class s{constructor(e){this.http=e;this.partners=[];this.showModal=!1;this.isEditing=!1;this.currentPartner={name:"",logo:"",type:"academic"};this.selectedFile=null;this.apiUrl=N.apiUrl}ngOnInit(){this.loadPartners()}loadPartners(){this.http.get(`${this.apiUrl}/partners`).subscribe({next:e=>this.partners=e,error:e=>console.error("Error loading partners",e)})}getTypeName(e){return{academic:"Acad\xE9mique",industrial:"Industriel",international:"International"}[e]||e}getImageUrl(e){return e?e.startsWith("http")||e.startsWith("assets/")?e:`${this.apiUrl}/${e}`:"assets/images/default-logo.png"}openModal(){this.isEditing=!1,this.currentPartner={name:"",logo:"",type:"academic"},this.selectedFile=null,this.showModal=!0}editPartner(e){this.isEditing=!0,this.currentPartner=S({},e),this.selectedFile=null,this.showModal=!0}deletePartner(e){confirm(`Supprimer le partenaire ${e.name} ?`)&&this.http.delete(`${this.apiUrl}/partners/${e._id}`).subscribe({next:()=>this.loadPartners(),error:i=>alert("Erreur lors de la suppression")})}closeModal(){this.showModal=!1}onFileSelected(e){this.selectedFile=e.target.files[0]}savePartner(){let e=new FormData;e.append("name",this.currentPartner.name),e.append("type",this.currentPartner.type),this.currentPartner.link&&e.append("link",this.currentPartner.link),this.selectedFile?e.append("logo",this.selectedFile):this.currentPartner.logo&&e.append("logo",this.currentPartner.logo),this.isEditing&&this.currentPartner._id?this.http.put(`${this.apiUrl}/partners/${this.currentPartner._id}`,e).subscribe({next:()=>{this.closeModal(),this.loadPartners()},error:i=>alert("Erreur lors de la modification")}):this.http.post(`${this.apiUrl}/partners`,e).subscribe({next:()=>{this.closeModal(),this.loadPartners()},error:i=>alert("Erreur lors de la cr\xE9ation")})}static{this.\u0275fac=function(i){return new(i||s)(E(T))}}static{this.\u0275cmp=M({type:s,selectors:[["app-admin-partners"]],decls:47,vars:11,consts:[[1,"container-fluid"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"text-navy","fw-bold"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus","me-2"],[1,"row","g-4"],["class","col-md-4",4,"ngFor","ngForOf"],["id","partnerModal","tabindex","-1",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["type","text","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","type","required","",1,"form-select",3,"ngModelChange","ngModel"],["value","academic"],["value","industrial"],["value","international"],["type","text","name","link",1,"form-control",3,"ngModelChange","ngModel"],["type","file","accept","image/*",1,"form-control",3,"change"],["class","mt-2",4,"ngIf"],[1,"d-flex","justify-content-end","gap-2"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary"],["class","modal-backdrop fade show",4,"ngIf"],[1,"col-md-4"],[1,"card","h-100","shadow-sm","border-0"],[1,"card-body","text-center"],[1,"img-fluid","mb-3",2,"max-height","100px","object-fit","contain",3,"src","alt"],[1,"card-title","fw-bold","text-navy"],[1,"badge","mb-2"],["class","small text-muted",4,"ngIf"],[1,"card-footer","bg-white","border-0","text-center","pb-3"],[1,"btn","btn-sm","btn-outline-primary","me-2",3,"click"],[1,"fas","fa-edit"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"fas","fa-trash"],[1,"small","text-muted"],["target","_blank",1,"text-secondary",3,"href"],[1,"fas","fa-link","me-1"],[1,"mt-2"],["height","50",3,"src"],[1,"modal-backdrop","fade","show"]],template:function(i,r){i&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),o(3,"Gestion des Partenaires"),t(),n(4,"button",3),p("click",function(){return r.openModal()}),c(5,"i",4),o(6," Nouveau Partenaire "),t()(),n(7,"div",5),g(8,R,14,11,"div",6),t(),n(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"h5",11),o(14),t(),n(15,"button",12),p("click",function(){return r.closeModal()}),t()(),n(16,"div",13)(17,"form",14),p("ngSubmit",function(){return r.savePartner()}),n(18,"div",15)(19,"label",16),o(20,"Nom du Partenaire"),t(),n(21,"input",17),P("ngModelChange",function(a){return b(r.currentPartner.name,a)||(r.currentPartner.name=a),a}),t()(),n(22,"div",15)(23,"label",16),o(24,"Type"),t(),n(25,"select",18),P("ngModelChange",function(a){return b(r.currentPartner.type,a)||(r.currentPartner.type=a),a}),n(26,"option",19),o(27,"Acad\xE9mique"),t(),n(28,"option",20),o(29,"Industriel"),t(),n(30,"option",21),o(31,"International"),t()()(),n(32,"div",15)(33,"label",16),o(34,"Lien (Site Web)"),t(),n(35,"input",22),P("ngModelChange",function(a){return b(r.currentPartner.link,a)||(r.currentPartner.link=a),a}),t()(),n(36,"div",15)(37,"label",16),o(38,"Logo"),t(),n(39,"input",23),p("change",function(a){return r.onFileSelected(a)}),t(),g(40,J,5,1,"div",24),t(),n(41,"div",25)(42,"button",26),p("click",function(){return r.closeModal()}),o(43,"Annuler"),t(),n(44,"button",27),o(45,"Enregistrer"),t()()()()()()(),g(46,K,1,0,"div",28),t()),i&2&&(l(8),m("ngForOf",r.partners),l(),x("display",r.showModal?"block":"none"),C("show",r.showModal),l(5),_("",r.isEditing?"Modifier":"Ajouter"," un Partenaire"),l(7),h("ngModel",r.currentPartner.name),l(4),h("ngModel",r.currentPartner.type),l(10),h("ngModel",r.currentPartner.link),l(5),m("ngIf",r.currentPartner.logo&&!r.selectedFile),l(6),m("ngIf",r.showModal))},dependencies:[F,A,I,B,D,j,q,U,L,W,O,z,$,V],styles:[".text-navy[_ngcontent-%COMP%]{color:#0055a4}"]})}};export{H as AdminPartnersComponent};
